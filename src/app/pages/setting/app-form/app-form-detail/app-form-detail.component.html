<div *ngIf="loading">
  <div class="loading" [nbSpinner]="loading" nbSpinnerStatus="success" nbSpinnerMessage="Loading Document...">
  </div>
</div>

<div *ngIf="!loading" id="app-form">

  <div class="header">
    <button mat-flat-button type="button" (click)="back()">
      <mat-icon>keyboard_backspace</mat-icon> Back
    </button>
    <button nbButton type="button" status="primary" (click)="preview()">
      <nb-icon icon="eye-outline"></nb-icon> PREVIEW
    </button>
  </div>

  <nb-card accent="success" [style.border-top-width.px]="10" style="margin-top: 0;">
    <nb-card-body style="padding-bottom: 0;">
      <mat-form-field appearance="outline">
        <mat-label>Name</mat-label>
        <input matInput type="text" id="formName" [(ngModel)]="appForm.formName" required>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Remark</mat-label>
        <input matInput type="text" id="formRemark" [(ngModel)]="appForm.formRemark">
      </mat-form-field>
      <div *ngIf="state === State.Edit && appForm.active" class="url-line">
        <div class="w-100">
          <input type="text" id="url" [(ngModel)]="url" nbInput fullWidth disabled style="color: #c5cee0;">
        </div>
        <button mat-icon-button type="button" matTooltip="Copy to clipboard" matTooltipPosition="above"
          (click)="copyToClipboard()">
          <mat-icon>file_copy</mat-icon>
        </button>
      </div>
    </nb-card-body>
  </nb-card>

  <nb-accordion>
    <nb-accordion-item [expanded]="true">
      <nb-accordion-item-header>
        Form Header
      </nb-accordion-item-header>
      <nb-accordion-item-body>
        <mat-form-field appearance="outline">
          <mat-label>Application Form Title</mat-label>
          <input matInput type="text" id="title" [(ngModel)]="appForm.title" required>
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Application Form Subtitle</mat-label>
          <input matInput type="text" id="subTitle" [(ngModel)]="appForm.subTitle">
        </mat-form-field>
        <mat-form-field appearance="outline" class="m-b-20">
          <mat-label>Background Color</mat-label>
          <input matInput type="text" id="bgColor" [(ngModel)]="appForm.bgColor" required>
          <mat-hint align="start" style="font-size: 20px;">
            <mat-icon *ngFor="let color of bgColors;" class="link" [style.color]="color"
              (click)="appForm.bgColor = color">lens</mat-icon>
            <mat-icon class="link" (click)="appForm.bgColor = '#ffffff'">panorama_fish_eye</mat-icon>
            <!-- <mat-icon class="link" (click)="addBgColor()">color_lens</mat-icon> -->
          </mat-hint>
        </mat-form-field>
        <div class="row">
          <div class="col-md-6">
            <mat-form-field appearance="outline" class="m-b-20">
              <mat-label>Title Color</mat-label>
              <input matInput type="text" id="titleColor" [(ngModel)]="appForm.titleColor" required>
              <mat-hint align="start" style="font-size: 20px;">
                <mat-icon class="link" (click)="appForm.titleColor = '#ffffff'">panorama_fish_eye</mat-icon>
                <mat-icon class="link" style="color: #707070;" (click)="appForm.titleColor = '#707070'">lens
                </mat-icon>
                <mat-icon class="link" style="color: #000000;" (click)="appForm.titleColor = '#000000'">lens
                </mat-icon>
              </mat-hint>
            </mat-form-field>
          </div>
          <div class="col-md-6">
            <mat-form-field appearance="outline" class="m-b-20">
              <mat-label>Subtitle Color</mat-label>
              <input matInput type="text" id="subTitleColor" [(ngModel)]="appForm.subTitleColor">
              <mat-hint align="start" style="font-size: 20px;">
                <mat-icon class="link" (click)="appForm.subTitleColor = '#ffffff'">panorama_fish_eye</mat-icon>
                <mat-icon class="link" style="color: #707070;" (click)="appForm.subTitleColor = '#707070'">lens
                </mat-icon>
                <mat-icon class="link" style="color: #000000;" (click)="appForm.subTitleColor = '#000000'">lens
                </mat-icon>
              </mat-hint>
            </mat-form-field>
          </div>
        </div>
        <div class="text-left">
          <p class="text-gray"><small>(Preview)</small></p>
          <div class="nav-bar" [style.background]="appForm.bgColor">
            <mat-icon [style.color]="appForm.titleColor">account_box</mat-icon>
            <div class="title" [style.color]="appForm.titleColor">{{ appForm.title }}</div>
            <div class="sub-title" [style.color]="appForm.subTitleColor">{{ appForm.subTitle }}</div>
          </div>
        </div>
      </nb-accordion-item-body>
    </nb-accordion-item>
  </nb-accordion>

  <nb-accordion>
    <nb-accordion-item [expanded]="true">
      <nb-accordion-item-header>
        Standard Form <small class="text-gray m-l-5">(Field controls)</small>
      </nb-accordion-item-header>
      <nb-accordion-item-body>
        <!-- Personal Details -->
        <div class="table-control table-control-header">
          <div class="table-control-name">
            <mat-checkbox [(ngModel)]="appForm.personalDetail.active">
              <span class="text-gray">Personal Details</span>
            </mat-checkbox>
          </div>
          <div class="table-control-actions">
            <span class="table-control-actions-item">Visible</span>
            <span class="table-control-actions-item">Required</span>
          </div>
        </div>
        <div *ngIf="appForm.personalDetail.active">
          <div *ngIf="appForm.personalDetail.idCard" class="table-control">
            <div class="table-control-name">ID Card</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.idCard.visible" (change)="changePersonalCheckbox()"
                  [disabled]="appForm.personalDetail.idCard.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.idCard.required"
                  [disabled]="!appForm.personalDetail.idCard.visible">
                </mat-checkbox>
              </div>
            </div>
          </div>
          <div *ngIf="appForm.personalDetail.firstname" class="table-control">
            <div class="table-control-name">First name (Thai)</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.firstname.visible"
                  (change)="changePersonalCheckbox()" [disabled]="appForm.personalDetail.firstname.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.firstname.required"
                  [disabled]="!appForm.personalDetail.firstname.visible">
                </mat-checkbox>
              </div>
            </div>
          </div>
          <div *ngIf="appForm.personalDetail.lastname" class="table-control">
            <div class="table-control-name">Last name (Thai)</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.lastname.visible"
                  (change)="changePersonalCheckbox()" [disabled]="appForm.personalDetail.lastname.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.lastname.required"
                  [disabled]="!appForm.personalDetail.lastname.visible"></mat-checkbox>
              </div>
            </div>
          </div>
          <div class="table-control">
            <div class="table-control-name">First name (Eng)</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.firstnameEN.visible" (change)="changePersonalCheckbox()"
                  [disabled]="appForm.personalDetail.firstnameEN.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.firstnameEN.required"
                  [disabled]="!appForm.personalDetail.firstnameEN.visible">
                </mat-checkbox>
              </div>
            </div>
          </div>
          <div class="table-control">
            <div class="table-control-name">Last name (Eng)</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.lastnameEN.visible" (change)="changePersonalCheckbox()"
                  [disabled]="appForm.personalDetail.lastnameEN.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.lastnameEN.required"
                  [disabled]="!appForm.personalDetail.lastnameEN.visible"></mat-checkbox>
              </div>
            </div>
          </div>
          <div class="table-control">
            <div class="table-control-name">Birthday</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.birth.visible" (change)="changePersonalCheckbox()"
                  [disabled]="appForm.personalDetail.birth.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.birth.required"
                  [disabled]="!appForm.personalDetail.birth.visible"></mat-checkbox>
              </div>
            </div>
          </div>
          <!-- <div class="table-control">
            <div class="table-control-name">Age</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.age.visible" (change)="changePersonalCheckbox()"
                  [disabled]="appForm.personalDetail.age.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.age.required"
                  [disabled]="!appForm.personalDetail.age.visible"></mat-checkbox>
              </div>
            </div>
          </div> -->
          <div class="table-control">
            <div class="table-control-name">Phone</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.phone.visible" (change)="changePersonalCheckbox()"
                  [disabled]="appForm.personalDetail.phone.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.phone.required"
                  [disabled]="!appForm.personalDetail.phone.visible"></mat-checkbox>
              </div>
            </div>
          </div>
          <div class="table-control">
            <div class="table-control-name">reservePhone</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.reservePhone.visible" (change)="changePersonalCheckbox()"
                  [disabled]="appForm.personalDetail.reservePhone.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.reservePhone.required"
                  [disabled]="!appForm.personalDetail.reservePhone.visible"></mat-checkbox>
              </div>
            </div>
          </div>
          <div class="table-control">
            <div class="table-control-name">Email</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.email.visible" (change)="changePersonalCheckbox()"
                  [disabled]="appForm.personalDetail.email.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.email.required"
                  [disabled]="!appForm.personalDetail.email.visible"></mat-checkbox>
              </div>
            </div>
          </div>
          <!-- <div class="table-control">
            <div class="table-control-name">Facebook</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.facebook.visible" (change)="changePersonalCheckbox()"
                [disabled]="appForm.personalDetail.facebook.disabled">
              </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.facebook.required"
                  [disabled]="!appForm.personalDetail.facebook.visible"></mat-checkbox>
              </div>
            </div>
          </div> -->
          <div class="table-control">
            <div class="table-control-name">Address</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.address.visible" (change)="changePersonalCheckbox()"
                  [disabled]="appForm.personalDetail.address.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.personalDetail.address.required"
                  [disabled]="!appForm.personalDetail.address.visible"></mat-checkbox>
              </div>
            </div>
          </div>
        </div>

        <!-- Work Experience -->
        <div class="table-control table-control-header">
          <div class="table-control-name">
            <mat-checkbox [(ngModel)]="appForm.workExperience.active">
              <span class="text-gray">Work Experience </span>
              <small class="text-red">{{ appForm.workExperience.active ? '' : '(Disable)' }}</small>
            </mat-checkbox>
          </div>
          <div class="table-control-actions" *ngIf="appForm.workExperience.active">
            <span class="table-control-actions-item">Visible</span>
            <span class="table-control-actions-item">Required</span>
          </div>
        </div>
        <div *ngIf="appForm.workExperience.active">
          <div class="table-control">
            <div class="table-control-name">Position</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.workExperience.position.visible"
                  (change)="changeWorkExperienceCheckbox()" [disabled]="appForm.workExperience.position.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.workExperience.position.required"
                  [disabled]="!appForm.workExperience.position.visible">
                </mat-checkbox>
              </div>
            </div>
          </div>
          <div class="table-control">
            <div class="table-control-name">Company</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.workExperience.company.visible"
                  (change)="changeWorkExperienceCheckbox()" [disabled]="appForm.workExperience.company.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.workExperience.company.required"
                  [disabled]="!appForm.workExperience.company.visible">
                </mat-checkbox>
              </div>
            </div>
          </div>
          <div class="table-control">
            <div class="table-control-name">Period from</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.workExperience.start.visible"
                  (change)="changeWorkExperienceCheckbox()" [disabled]="appForm.workExperience.start.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.workExperience.start.required"
                  [disabled]="!appForm.workExperience.start.visible">
                </mat-checkbox>
              </div>
            </div>
          </div>
          <div class="table-control">
            <div class="table-control-name">Period to</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.workExperience.end.visible" (change)="changeWorkExperienceCheckbox()"
                  [disabled]="appForm.workExperience.end.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.workExperience.end.required"
                  [disabled]="!appForm.workExperience.end.visible">
                </mat-checkbox>
              </div>
            </div>
          </div>
          <div class="table-control">
            <div class="table-control-name">Roles and responsibilities</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.workExperience.duty.visible"
                  (change)="changeWorkExperienceCheckbox()" [disabled]="appForm.workExperience.duty.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.workExperience.duty.required"
                  [disabled]="!appForm.workExperience.duty.visible">
                </mat-checkbox>
              </div>
            </div>
          </div>
        </div>

        <!-- Education -->
        <div class="table-control table-control-header">
          <div class="table-control-name">
            <mat-checkbox [(ngModel)]="appForm.education.active">
              <span class="text-gray">Education </span>
              <small class="text-red">{{ appForm.education.active ? '' : '(Disable)' }}</small>
            </mat-checkbox>
          </div>
          <div class="table-control-actions" *ngIf="appForm.education.active">
            <span class="table-control-actions-item">Visible</span>
            <span class="table-control-actions-item">Required</span>
          </div>
        </div>
        <div *ngIf="appForm.education.active">
          <div class="table-control">
            <div class="table-control-name">Degree</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.education.refDegree.visible" (change)="changeEducationCheckbox()"
                  [disabled]="appForm.education.refDegree.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.education.refDegree.required"
                  [disabled]="!appForm.education.refDegree.visible">
                </mat-checkbox>
              </div>
            </div>
          </div>
          <div class="table-control">
            <div class="table-control-name">GPA</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.education.gpa.visible" (change)="changeEducationCheckbox()"
                  [disabled]="appForm.education.gpa.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.education.gpa.required" [disabled]="!appForm.education.gpa.visible">
                </mat-checkbox>
              </div>
            </div>
          </div>
          <div class="table-control">
            <div class="table-control-name">University</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.education.university.visible" (change)="changeEducationCheckbox()"
                  [disabled]="appForm.education.university.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.education.university.required"
                  [disabled]="!appForm.education.university.visible">
                </mat-checkbox>
              </div>
            </div>
          </div>
          <div class="table-control">
            <div class="table-control-name">Major</div>
            <div class="table-control-actions">
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.education.major.visible" (change)="changeEducationCheckbox()"
                  [disabled]="appForm.education.major.disabled">
                </mat-checkbox>
              </div>
              <div class="table-control-actions-item">
                <mat-checkbox [(ngModel)]="appForm.education.major.required"
                  [disabled]="!appForm.education.major.visible">
                </mat-checkbox>
              </div>
            </div>
          </div>
        </div>

        <!-- Hard Skills -->
        <div class="table-control table-control-header">
          <div class="table-control-name">
            <mat-checkbox [(ngModel)]="appForm.hardSkill.active">
              <span class="text-gray">Hard Skills </span>
              <small class="text-red">{{ appForm.hardSkill.active ? '' : '(Disable)' }}</small>
            </mat-checkbox>
          </div>
        </div>

        <!-- Soft Skills -->
        <div class="table-control table-control-header">
          <div class="table-control-name">
            <mat-checkbox [(ngModel)]="appForm.softSkill.active">
              <span class="text-gray">Soft Skills </span>
              <small class="text-red">{{ appForm.softSkill.active ? '' : '(Disable)' }}</small>
            </mat-checkbox>
          </div>
        </div>

        <!-- Certifications -->
        <div class="table-control table-control-header">
          <div class="table-control-name">
            <mat-checkbox [(ngModel)]="appForm.certificate.active">
              <span class="text-gray">Certifications </span>
              <small class="text-red">{{ appForm.certificate.active ? '' : '(Disable)' }}</small>
            </mat-checkbox>
          </div>
        </div>

        <!-- Upload CV -->
        <div class="table-control table-control-header">
          <div class="table-control-name">
            <mat-checkbox [(ngModel)]="appForm.uploadCV.active">
              <span class="text-gray">Upload CV/Resume </span>
              <small class="text-red">{{ appForm.uploadCV.active ? '' : '(Disable)' }}</small>
            </mat-checkbox>
          </div>
        </div>

      </nb-accordion-item-body>
    </nb-accordion-item>
  </nb-accordion>

  <!-- Job Position -->
  <nb-accordion id="jobPosition" *ngIf="isExpress" [nbSpinner]="loadingJob" nbSpinnerStatus="success"
    nbSpinnerMessage="Loading...">
    <nb-accordion-item [expanded]="true">
      <nb-accordion-item-header>
        <div>
          Job Position
          <span class="text-red">*</span>
          <small class="text-gray m-l-5">(Job positions showing in Application form)</small>
          <small class="text-red m-l-5">{{ jobPositionError }}</small>
        </div>
      </nb-accordion-item-header>
      <nb-accordion-item-body style="font-size: 14px;">
        <div *ngFor="let jobPosition of jobPositions; let i = index;" style="margin-bottom: 0.5rem;">
          <mat-checkbox [(ngModel)]="jobPosition.active">
            {{ jobPosition.name }}
          </mat-checkbox>
        </div>
        <!-- <div class="text-center">
          <button mat-flat-button type="button" color="primary" (click)="getJobPosition()" [disabled]="loadingJob">
            <mat-icon class="text-white">refresh</mat-icon> Update job position
          </button>
        </div> -->
      </nb-accordion-item-body>
    </nb-accordion-item>
  </nb-accordion>

  <!-- Question -->
  <nb-card id="question" class="m-0">
    <nb-card-header>
      Other Forms<small class="text-gray m-l-5">(Can design many forms)</small>
      <div><small class="text-red">{{ questionError }}</small></div>
    </nb-card-header>
  </nb-card>
  <div cdkDropList class="question-block" (cdkDropListDropped)="drop($event)">
    <nb-card *ngFor="let question of appForm.questions; let iQuestion = index;"
      accent="{{ question.required ? 'danger' : 'default' }}" cdkDrag>

      <!-- Question Header -->
      <nb-card-header style="padding-bottom: 10px;">
        <div class="icon-move" cdkDragHandle>
          <mat-icon>drag_indicator</mat-icon>
        </div>
        <div class="console">
          <div class="text-left">
            <mat-form-field appearance="outline" class="fit-content" style="width: 220px;">
              <mat-label>Question Type</mat-label>
              <mat-select [(ngModel)]="question.type">
                <mat-select-trigger>
                  <mat-icon>{{ getSelectedType(question.type) }}</mat-icon>
                  <span class="select-label">{{ question.type }}</span>
                </mat-select-trigger>
                <mat-option [value]="InputType.Label"
                  (click)="question.imgaeURL = ''; question.required = false; fileInput.value = ''">
                  <mat-icon>text_fields</mat-icon> {{ InputType.Label }}
                </mat-option>
                <mat-divider></mat-divider>
                <mat-option [value]="InputType.Input">
                  <mat-icon>short_text</mat-icon> {{ InputType.Input }}
                </mat-option>
                <mat-option [value]="InputType.TextArea">
                  <mat-icon>subject</mat-icon> {{ InputType.TextArea }}
                </mat-option>
                <mat-divider></mat-divider>
                <mat-option [value]="InputType.Radio">
                  <mat-icon>radio_button_checked</mat-icon> {{ InputType.Radio }}
                </mat-option>
                <mat-option [value]="InputType.ChcekBox">
                  <mat-icon>check_box</mat-icon> {{ InputType.ChcekBox }}
                </mat-option>
                <mat-option [value]="InputType.Dropdown">
                  <mat-icon>arrow_drop_down_circle</mat-icon> {{ InputType.Dropdown }}
                </mat-option>
                <mat-option [value]="InputType.ParentChild">
                  <mat-icon>share</mat-icon> {{ InputType.ParentChild }}
                </mat-option>
                <mat-divider></mat-divider>
                <mat-option [value]="InputType.Upload">
                  <mat-icon>cloud_upload</mat-icon> {{ InputType.Upload }}
                </mat-option>
                <mat-divider></mat-divider>
                <mat-option [value]="InputType.Linear">
                  <mat-icon>linear_scale</mat-icon> {{ InputType.Linear }}
                </mat-option>
                <mat-option [value]="InputType.RadioGrid">
                  <mat-icon>drag_indicator</mat-icon> {{ InputType.RadioGrid }}
                </mat-option>
                <mat-option [value]="InputType.ChcekBoxGrid">
                  <mat-icon>apps</mat-icon> {{ InputType.ChcekBoxGrid }}
                </mat-option>
                <mat-divider></mat-divider>
                <mat-option [value]="InputType.Date">
                  <mat-icon>event</mat-icon> {{ InputType.Date }}
                </mat-option>
                <mat-option [value]="InputType.Time">
                  <mat-icon>access_time</mat-icon> {{ InputType.Time }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="text-right">
            <button mat-icon-button type="button" [matMenuTriggerFor]="menu">
              <mat-icon>more_vert</mat-icon>
            </button>
            <mat-menu #menu="matMenu">
              <button mat-menu-item type="button" (click)="question.showSubTitle = !question.showSubTitle">
                <mat-icon [ngClass]="{ 'text-green' : question.showSubTitle }">
                  {{ question.showSubTitle ? 'check_box' : 'check_box_outline_blank' }}
                </mat-icon>
                <span>Show Description</span>
              </button>
              <button *ngIf="question.type !== InputType.Label" mat-menu-item type="button"
                (click)="question.required = !question.required">
                <mat-icon [ngClass]="{ 'text-green' : question.required }">
                  {{ question.required ? 'check_box' : 'check_box_outline_blank' }}
                </mat-icon>
                <span>Required</span>
              </button>
              <button *ngIf="question.type === InputType.Radio || question.type === InputType.ChcekBox
                || question.type === InputType.Dropdown || question.type === InputType.ParentChild" mat-menu-item
                type="button" (click)="question.isFilter = !question.isFilter">
                <mat-icon [ngClass]="{ 'text-green' : question.isFilter }">
                  {{ question.isFilter ? 'check_box' : 'check_box_outline_blank' }}
                </mat-icon>
                <span>Make a filter</span>
              </button>
              <mat-divider></mat-divider>
              <button mat-menu-item type="button" (click)="duplicateQuestion(iQuestion)">
                <mat-icon>filter_none</mat-icon>
                <span>Duplicate</span>
              </button>
              <button mat-menu-item type="button" (click)="deleteQuestion(iQuestion)">
                <mat-icon>delete</mat-icon>
                <span>Delete</span>
              </button>
            </mat-menu>
          </div>
        </div>

        <div class="console m-t-15">
          <div class="w-100">
            <mat-form-field>
              <mat-label>{{ question.type === InputType.Label ? 'Title' : 'Question' }}</mat-label>
              <input matInput type="text" id="qTitle_{{iQuestion}}" [(ngModel)]="question.title"
                (click)="$event.target.select()" required>
            </mat-form-field>
          </div>
          <button *ngIf="question.type !== InputType.Label" mat-icon-button type="button" (click)="fileInput.click()">
            <mat-icon class="showPhoto">photo</mat-icon>
            <input #fileInput type="file" (change)="uploadFile(question, $event.target.files)" style="display:none;"
              accept="image/*" />
          </button>
        </div>

        <small>
          <mat-form-field *ngIf="question.showSubTitle">
            <mat-label>Description</mat-label>
            <input matInput type="text" id="qSubTitle_{{iQuestion}}" [(ngModel)]="question.subTitle"
              (click)="$event.target.select()" required>
          </mat-form-field>
        </small>
      </nb-card-header>

      <!-- Answer -->
      <nb-accordion *ngIf="question.type !== InputType.Label" class="answer">
        <nb-accordion-item [expanded]="true">
          <nb-accordion-item-header style="background: #f9f9f9;">
            Answer
          </nb-accordion-item-header>
          <nb-accordion-item-body>

            <div class="text-center">
              <div *ngIf="question.imgaeURL" class="image-preview">
                <img [src]="question.imgaeURL" class="w-100">
                <div class="icon-remove">
                  <button mat-icon-button type="button" (click)="question.imgaeURL = ''; fileInput.value = ''">
                    <mat-icon>close</mat-icon>
                  </button>
                </div>
              </div>
            </div>

            <div *ngIf="question.type === InputType.Input">
              <div class="row">
                <div class="offset-lg-2 col-lg-8">
                  <mat-form-field appearance="outline" style="margin-bottom: -20px;">
                    <mat-label>Short Answer</mat-label>
                    <input matInput type="text" [(ngModel)]="question.answer.input" disabled>
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div *ngIf="question.type === InputType.TextArea">
              <div class="row">
                <div class="offset-lg-2 col-lg-8">
                  <mat-form-field appearance="outline" style="margin-bottom: -20px;">
                    <mat-label>Paragraph</mat-label>
                    <textarea matInput type="text" [(ngModel)]="question.answer.textArea" rows="3" disabled></textarea>
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div *ngIf="question.type === InputType.Radio 
              || question.type === InputType.ChcekBox 
              || question.type === InputType.Dropdown">
              <div *ngFor="let option of question.answer.options; let iOption = index;">
                <div class="radio-line">
                  <mat-icon>{{ getSelectedOption(question.type) }}</mat-icon>
                  <mat-form-field class="w-100 m-l-10">
                    <input matInput type="text" id="qLabel_{{iQuestion}}_{{iOption}}" [(ngModel)]="option.label"
                      (click)="$event.target.select()" required>
                  </mat-form-field>
                  <button *ngIf="question.type === InputType.Radio || question.type === InputType.ChcekBox"
                    mat-icon-button type="button" (click)="fileInput.click()">
                    <mat-icon class="showPhoto">photo</mat-icon>
                    <input #fileInput type="file" (change)="uploadFile(option, $event.target.files)"
                      style="display:none;" accept="image/*" />
                  </button>
                  <div class="button-close">
                    <button mat-icon-button type="button" *ngIf="question.answer.options.length > 1"
                      (click)="deleteOption(iQuestion, iOption)">
                      <mat-icon>close</mat-icon>
                    </button>
                  </div>
                </div>
                <div *ngIf="option.imgaeURL" class="image-preview">
                  <img [src]="option.imgaeURL" width="200">
                  <div class="icon-remove">
                    <button mat-icon-button type="button" (click)="option.imgaeURL = ''; fileInput.value = ''">
                      <mat-icon>close</mat-icon>
                    </button>
                  </div>
                </div>
              </div>
              <div *ngIf="question.answer.hasOther" class="radio-line">
                <mat-icon>{{ getSelectedOption(question.type) }}</mat-icon>
                <mat-form-field>
                  <input matInput type="text" id="qOtherLabel_{{iQuestion}}_{{iQuestion}}"
                    [(ngModel)]="question.answer.otherLabel" disabled>
                </mat-form-field>
                <button mat-icon-button type="button" (click)="question.answer.hasOther = false">
                  <mat-icon>close</mat-icon>
                </button>
              </div>
              <div class="radio-line-add">
                <mat-icon class="text-light-gray m-r-10">{{ getSelectedOption(question.type) }}</mat-icon>
                <span class="link" (click)="addOption(question.answer.options)">Add Option</span>
                <span *ngIf="!question.answer.hasOther" class="m-l-10 m-r-10">|</span>
                <span *ngIf="!question.answer.hasOther" class="link" (click)="question.answer.hasOther = true">Add
                  Other</span>
              </div>
            </div>

            <div *ngIf="question.type === InputType.ParentChild">
              <div *ngFor="let parent of question.parentChild; let iParent = index" style="margin-bottom: 1.5rem;">
                <div class="radio-line">
                  <mat-icon>fiber_manual_record</mat-icon>
                  <mat-form-field>
                    <input matInput type="text" id="parent_{{iQuestion}}_{{iParent}}" [(ngModel)]="parent.name"
                      (click)="$event.target.select()" required>
                  </mat-form-field>
                  <button *ngIf="parent.children.length" mat-icon-button type="button" [matMenuTriggerFor]="menu">
                    <mat-icon>more_vert</mat-icon>
                  </button>
                  <mat-menu #menu="matMenu">
                    <button mat-menu-item type="button" (click)="parent.required = !parent.required">
                      <mat-icon [ngClass]="{ 'text-green' : parent.required }">
                        {{ parent.required ? 'check_box' : 'check_box_outline_blank' }}
                      </mat-icon>
                      <span>Item Required</span>
                    </button>
                    <button mat-menu-item type="button" (click)="parent.isMultiAnswer = !parent.isMultiAnswer">
                      <mat-icon [ngClass]="{ 'text-green' : parent.isMultiAnswer }">
                        {{ parent.isMultiAnswer ? 'check_box' : 'check_box_outline_blank' }}
                      </mat-icon>
                      <span>Multiple Answer</span>
                    </button>
                  </mat-menu>
                  <button mat-icon-button type="button" (click)="deleteParent(iQuestion, iParent)">
                    <mat-icon>close</mat-icon>
                  </button>
                </div>
                <div style="padding-left: 2rem;">
                  <div *ngFor="let child of parent.children; let iChild = index" class="radio-line">
                    <mat-icon [ngClass]="{ 'text-red' : parent.required }">
                      {{ parent.isMultiAnswer ? 'check_box_outline_blank' : 'fiber_manual_record' }}
                    </mat-icon>
                    <mat-form-field>
                      <input matInput type="text" id="child_{{iQuestion}}_{{iParent}}_{{iChild}}"
                        [(ngModel)]="child.name" (click)="$event.target.select()" required>
                    </mat-form-field>
                    <button mat-icon-button type="button" (click)="deleteChild(iQuestion, iParent, iChild)">
                      <mat-icon>close</mat-icon>
                    </button>
                  </div>
                  <div class="radio-line-add">
                    <mat-icon class="text-light-gray m-r-10">
                      {{ parent.isMultiAnswer ? 'check_box_outline_blank' : 'fiber_manual_record' }}
                    </mat-icon>
                    <span class="link" (click)="appChild(iQuestion, iParent)">Add Child</span>
                  </div>
                </div>
              </div>
              <div class="radio-line-add" style="padding-top: 0.5rem;">
                <mat-icon class="text-light-gray m-r-10">fiber_manual_record</mat-icon>
                <span class="link" (click)="addParent(iQuestion)">Add Parent</span>
              </div>
            </div>

            <div *ngIf="question.type === InputType.Upload" class="text-center">
              <button mat-flat-button type="button" disabled>
                <mat-icon class="m-r-5">cloud_upload</mat-icon> Upload file
              </button>
            </div>

            <div *ngIf="question.type === InputType.Linear">
              <div class="linear">
                <mat-form-field style="width: 75px;">
                  <mat-select [(ngModel)]="question.linear.fromValue" class="text-center"
                    (selectionChange)="setLinearOptions(question)">
                    <mat-option *ngFor="let value of lenearFrom" [value]="value">{{ value }}</mat-option>
                  </mat-select>
                </mat-form-field>
                <span class="linear-to">to</span>
                <mat-form-field style="width: 75px;">
                  <mat-select [(ngModel)]="question.linear.toValue" class="text-center"
                    (selectionChange)="setLinearOptions(question)">
                    <mat-option *ngFor="let value of lenearTo" [value]="value">{{ value }}</mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="linear">
                <span class="linear-label">{{ question.linear.fromValue }}</span>
                <mat-form-field>
                  <input matInput type="text" [(ngModel)]="question.linear.fromLabel" placeholder="Label (optional)">
                </mat-form-field>
              </div>
              <div class="linear">
                <span class="linear-label">{{ question.linear.toValue }}</span>
                <mat-form-field>
                  <input matInput type="text" [(ngModel)]="question.linear.toLabel" placeholder="Label (optional)">
                </mat-form-field>
              </div>
            </div>

            <div *ngIf="question.type === InputType.RadioGrid || question.type === InputType.ChcekBoxGrid" class="row">
              <div class="col-md-6">
                <label style="font-weight: 700;">Rows</label>
                <div class="radio-line" *ngFor="let row of question.grid.rows; let iGridRow = index">
                  <span>{{ iGridRow + 1 }}.</span>
                  <mat-form-field>
                    <input matInput type="text" id="gridRow_{{iQuestion}}_{{iGridRow}}" [(ngModel)]="row.label"
                      (click)="$event.target.select()" required>
                  </mat-form-field>
                  <div class="button-close">
                    <button mat-icon-button type="button" *ngIf="question.grid.rows.length > 1"
                      (click)="deleteGridRow(iQuestion, iGridRow); oncChangeGridRowScore(question);">
                      <mat-icon>close</mat-icon>
                    </button>
                  </div>
                </div>
                <div class="radio-line-add">
                  <span class="text-gray m-r-10">{{ question.grid.rows.length + 1 }}.</span>
                  <span class="link" (click)="addGridRow(question.grid.rows); oncChangeGridRowScore(question);">
                    Add row
                  </span>
                </div>
              </div>
              <div class="col-md-6">
                <label style="font-weight: 700;">Columns</label>
                <div class="radio-line" *ngFor="let column of question.grid.columns; let iGridCol = index">
                  <mat-icon>{{ getSelectedOption(question.type) }}</mat-icon>
                  <mat-form-field class="w-100 m-l-10">
                    <input matInput type="text" id="gridCol_{{iQuestion}}_{{iGridCol}}" [(ngModel)]="column.label"
                      (click)="$event.target.select()" required>
                  </mat-form-field>
                  <div class="button-close">
                    <button mat-icon-button type="button" *ngIf="question.grid.columns.length > 1"
                      (click)="deleteGridColumn(iQuestion, iGridCol)">
                      <mat-icon>close</mat-icon>
                    </button>
                  </div>
                </div>
                <div class="radio-line-add">
                  <mat-icon class="text-light-gray m-r-10">{{ getSelectedOption(question.type) }}</mat-icon>
                  <span class="link" (click)="addGridColumn(question.grid.columns)">Add column</span>
                </div>
              </div>
            </div>

            <div *ngIf="question.type === InputType.Date" class="text-center">
              <mat-form-field appearance="outline"
                style="display: inline-block !important; width: 250px; margin-bottom: -20px;">
                <mat-label>Date</mat-label>
                <input matInput disabled>
                <mat-icon matSuffix>event</mat-icon>
              </mat-form-field>
            </div>

            <div *ngIf="question.type === InputType.Time" class="text-center">
              <mat-form-field appearance="outline"
                style="display: inline-block !important; width: 250px; margin-bottom: -20px;">
                <mat-label>Time</mat-label>
                <input matInput disabled>
                <mat-icon matSuffix>access_time</mat-icon>
              </mat-form-field>
            </div>

          </nb-accordion-item-body>
        </nb-accordion-item>
      </nb-accordion>

      <!-- Score -->
      <div *ngIf="isExpress">
        <nb-accordion class="score" *ngIf="question.type !== InputType.Label
        && question.type !== InputType.Date && question.type !== InputType.Time">
          <nb-accordion-item [expanded]="question.score?.isScore" [disabled]="!question.score?.isScore">
            <nb-accordion-item-header style="background: #f9f9f9;">
              <div class="row w-100">
                <div class="col-6">
                  <mat-slide-toggle labelPosition="before" [(ngModel)]="question.score.isScore"
                    (change)="toggleScoreCalculator(question,'score')" class="toggle">
                    Score calculator:
                  </mat-slide-toggle>
                </div>
                <div *ngIf="question.score.isScore" class="col-6 text-right">
                  <span class="m-r-20">
                    <span style="color: #999;">Grand Total : </span>
                    <span [ngClass]="{ 'text-red' : totalScore !== 100, 'text-green': totalScore === 100 }"
                      style="font-size: 1.2rem;">
                      {{ totalScore }}
                    </span>
                    <span style="color: #999;">/100%</span>
                  </span>
                </div>
              </div>
            </nb-accordion-item-header>
            <nb-accordion-item-body>
              <div *ngIf="question.type !== InputType.RadioGrid && question.type !== InputType.ChcekBoxGrid">
                <span style="padding-left: 8px;">
                  <small class="m-r-5">Max Score <span class="text-red">*</span></small>
                  ({{ question.score.maxScore }}%)
                </span>
                <mat-slider class="w-100" color="primary" [max]="getMaxScore(question.score.maxScore)" min="0" step="1"
                  [thumbLabel]="true" [tickInterval]="10" [(ngModel)]="question.score.maxScore"
                  (change)="calGrandScore(); setLinearOptions(question)"
                  [disabled]="question.score.maxScore === 0 && totalScore === 100">
                </mat-slider>
              </div>

              <div *ngIf="question.type === InputType.Input || question.type === InputType.TextArea">
                <mat-form-field appearance="outline">
                  <mat-label>Keyword</mat-label>
                  <mat-chip-list #chipList>
                    <mat-chip *ngFor="let keyword of question.score.keywords; let iKeyword = index;" [selectable]="true"
                      [removable]="true" (removed)="removeKeyword(question.score.keywords, iKeyword)">
                      {{ keyword }}
                      <mat-icon matChipRemove>cancel</mat-icon>
                    </mat-chip>
                    <input placeholder="+ New" [matChipInputFor]="chipList"
                      [matChipInputSeparatorKeyCodes]="separatorKeysCodes" [matChipInputAddOnBlur]="true"
                      (matChipInputTokenEnd)="addKeyword(question.score.keywords, $event)" required>
                  </mat-chip-list>
                  <mat-hint>*Insert any keyword for matching with answer.</mat-hint>
                </mat-form-field>
              </div>

              <div *ngIf="question.type === InputType.Radio || question.type === InputType.Dropdown">
                <div *ngIf="question.score.maxScore > 0" class="score-body">
                  <div *ngFor="let option of question.answer.options; let iScore = index">
                    <small class="score-scale-left">{{ option.label }}</small>
                    <small class="score-scale-right">
                      ({{ option.maxScore }}/{{ question.score.maxScore }})
                    </small>
                    <mat-slider class="w-100" color="primary" [max]="question.score.maxScore" min="0" step="1"
                      [thumbLabel]="true" [tickInterval]="10" [(ngModel)]="option.maxScore"
                      [ngClass]="{ 'h-36': iScore === question.answer.options.length - 1 && !question.answer.hasOther }">
                    </mat-slider>
                  </div>
                  <div *ngIf="question.answer.hasOther">
                    <small class="score-scale-left">{{ question.answer.otherLabel }}</small>
                    <small class="score-scale-right">
                      ({{ question.answer.otherScore }}/{{ question.score.maxScore }})
                    </small>
                    <mat-slider class="w-100 h-36" color="primary" [max]="question.score.maxScore" min="0" step="1"
                      [thumbLabel]="true" [tickInterval]="10" [(ngModel)]="question.answer.otherScore">
                    </mat-slider>
                  </div>
                </div>
              </div>

              <div *ngIf="question.type === InputType.ParentChild">
                <div *ngIf="question.score.maxScore > 0" class="score-body">
                  <div *ngFor="let parent of question.parentChild; let iScore = index">
                    <small class="score-scale-left">{{ parent.name }}</small>
                    <small class="score-scale-right">
                      ({{ parent.maxScore }}/{{ question.score.maxScore }})
                    </small>
                    <mat-slider class="w-100" color="primary" [max]="question.score.maxScore" min="0" step="1"
                      [thumbLabel]="true" [tickInterval]="10" [(ngModel)]="parent.maxScore"
                      [ngClass]="{ 'h-36': iScore === question.parentChild.length - 1 }">
                    </mat-slider>
                  </div>
                </div>
              </div>

              <div *ngIf="question.type === InputType.ChcekBox">
                <div *ngIf="question.score.maxScore > 0" class="score-body">
                  <div class="text-center m-b-10">
                    <small class="text-gray m-r-5">Total score :</small>
                    <small [ngClass]="
                    { 'text-red' : getTotalScore(question) !== question.score.maxScore, 
                      'text-green': getTotalScore(question) === question.score.maxScore }">
                      {{ getTotalScore(question) }}
                    </small>
                    <small style="color: #999;">/{{ question.score.maxScore }}</small>
                  </div>
                  <div *ngFor="let option of question.answer.options; let iScore = index">
                    <small class="score-scale-left">{{ option.label }}</small>
                    <small class="score-scale-right">
                      ({{ option.maxScore }})
                    </small>
                    <mat-slider class="w-100" color="primary" [max]="question.score.maxScore" min="0" step="1"
                      [thumbLabel]="true" [tickInterval]="10" [(ngModel)]="option.maxScore">
                    </mat-slider>
                  </div>
                  <div *ngIf="question.answer.hasOther">
                    <small class="score-scale-left">{{ question.answer.otherLabel }}</small>
                    <small class="score-scale-right">
                      ({{ question.answer.otherScore }})
                    </small>
                    <mat-slider class="w-100" color="primary" [max]="question.score.maxScore" min="0" step="1"
                      [thumbLabel]="true" [tickInterval]="10" [(ngModel)]="question.answer.otherScore">
                    </mat-slider>
                  </div>
                  <div class="text-center">
                    <button mat-flat-button type="button" color="primary" (click)="autoCalScoreCheckbox(question)">
                      <mat-icon class="text-white">refresh</mat-icon> Auto generate score
                    </button>
                  </div>
                </div>
              </div>

              <div *ngIf="question.type === InputType.Upload">
                <small style="color: #999;">*Have a score when file uploaded.</small>
              </div>

              <div *ngIf="question.type === InputType.Linear">
                <div *ngIf="question.score.maxScore > 0" class="score-body">
                  <div *ngFor="let option of question.answer.linearOptions; let iLinear = index">
                    <small class="score-scale-left">{{ option.label }}</small>
                    <small class="score-scale-right">
                      ({{ option.maxScore }}/{{ question.score.maxScore }})
                    </small>
                    <mat-slider class="w-100" color="primary" [max]="question.score.maxScore" min="0" step="1"
                      [thumbLabel]="true" [tickInterval]="10" [(ngModel)]="option.maxScore">
                    </mat-slider>
                  </div>
                  <div class="text-center">
                    <button mat-flat-button type="button" color="primary" (click)="setLinearOptions(question)">
                      <mat-icon class="text-white">refresh</mat-icon> Auto generate score
                    </button>
                  </div>
                </div>
              </div>

              <div *ngIf="question.type === InputType.RadioGrid">
                <span style="padding-left: 8px;">
                  <small class="m-r-5">Total Score ({{ question.grid.rows.length }} rows) :</small>
                  {{ question.score.maxScore }}%
                </span>
                <mat-slider class="w-100" color="primary" max="100" min="0" step="1" [thumbLabel]="true"
                  [tickInterval]="10" [(ngModel)]="question.score.maxScore" disabled>
                </mat-slider>
                <div class="row">
                  <div class="col-md-6">
                    <div class="score-body">
                      <span style="padding-left: 8px;">
                        <small class="text-gray m-r-5">Score per 1 row <span class="text-red">*</span></small>
                        ({{ question.score.girdRowScore }}%)
                      </span>
                      <mat-slider class="w-100 h-36" color="primary" [max]="getMaxScore(question.score.maxScore)"
                        min="0" step="1" [thumbLabel]="true" [tickInterval]="10"
                        [(ngModel)]="question.score.girdRowScore" (change)="oncChangeGridRowScore(question)">
                      </mat-slider>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="score-body">
                      <div *ngFor="let option of question.grid.columns; let iScore = index">
                        <small class="score-scale-left">{{ option.label }}</small>
                        <small class="score-scale-right">
                          ({{ option.maxScore }}/{{ question.score.girdRowScore }})
                        </small>
                        <mat-slider class="w-100" color="primary" [max]="question.score.girdRowScore" min="0" step="1"
                          [thumbLabel]="true" [tickInterval]="10" [(ngModel)]="option.maxScore"
                          [ngClass]="{ 'h-36': iScore === question.grid.columns.length - 1 }">
                        </mat-slider>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div *ngIf="question.type === InputType.ChcekBoxGrid">
                <span style="padding-left: 8px;">
                  <small class="m-r-5">Total Score ({{ question.grid.rows.length }} rows) :</small>
                  {{ question.score.maxScore }}%
                </span>
                <mat-slider class="w-100" color="primary" max="100" min="0" step="1" [thumbLabel]="true"
                  [tickInterval]="10" [(ngModel)]="question.score.maxScore" disabled>
                </mat-slider>
                <div class="row">
                  <div class="col-md-6">
                    <div class="score-body">
                      <span style="padding-left: 8px;">
                        <small class="text-gray m-r-5">Score per 1 row <span class="text-red">*</span></small>
                        ({{ question.score.girdRowScore }}%)
                      </span>
                      <mat-slider class="w-100 h-36" color="primary" [max]="getMaxScore(question.score.maxScore)"
                        min="0" step="1" [thumbLabel]="true" [tickInterval]="10"
                        [(ngModel)]="question.score.girdRowScore" (change)="oncChangeGridRowScore(question)">
                      </mat-slider>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="score-body">
                      <div class="text-center m-b-10">
                        <small class="text-gray m-r-5">Total score :</small>
                        <small [ngClass]="
                        { 'text-red' : getTotalScore(question) !== question.score.girdRowScore, 
                          'text-green': getTotalScore(question) === question.score.girdRowScore }">
                          {{ getTotalScore(question) }}
                        </small>
                        <small style="color: #999;">/{{ question.score.girdRowScore }}</small>
                      </div>
                      <div *ngFor="let option of question.grid.columns; let iScore = index">
                        <small class="score-scale-left">{{ option.label }}</small>
                        <small class="score-scale-right">
                          ({{ option.maxScore }})
                        </small>
                        <mat-slider class="w-100" color="primary" [max]="question.score.girdRowScore" min="0" step="1"
                          [thumbLabel]="true" [tickInterval]="10" [(ngModel)]="option.maxScore">
                        </mat-slider>
                      </div>
                      <div class="text-center">
                        <button mat-flat-button type="button" color="primary" (click)="autoCalScoreCheckbox(question)">
                          <mat-icon class="text-white">refresh</mat-icon> Auto generate score
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

            </nb-accordion-item-body>
          </nb-accordion-item>
        </nb-accordion>
      </div>
      <!-- Condition -->
      <div *ngIf="isExpress">
        <nb-accordion class="score" *ngIf="question.type === InputType.Radio">
          <nb-accordion-item [expanded]="question.score?.isAnswer" [disabled]="!question.score?.isAnswer">
            <nb-accordion-item-header style="background: #f9f9f9;">
              <div class="row w-100">
                <div class="col-6">
                  <mat-slide-toggle labelPosition="before" [(ngModel)]="question.score.isAnswer"
                    (change)="toggleScoreCalculator(question,'answer')" class="toggle">
                    Expect Answer
                  </mat-slide-toggle>
                </div>
              </div>
            </nb-accordion-item-header>
            <nb-accordion-item-body>

              <mat-radio-group [(ngModel)]="question.answer.expected" [required]="question.required"
                [ngModelOptions]="{standalone: true}" [disabled]="isDisabled">

                <div *ngFor="let option of question.answer.options; let i = index" class="m-b-15"
                  [ngClass]="{ 'col-md-6' : option.imgaeURL, 'col-md-12': !option.imgaeURL}">
                  <div *ngIf="option.imgaeURL" class="answer-image"
                    [ngClass]="{ 'active': question.answer.expected === i }" (click)="question.answer.expected = i">
                    <img [src]="option.imgaeURL">
                  </div>
                  <mat-radio-button [value]="i">
                    {{ option.label }}
                  </mat-radio-button>
                </div>
                <div class="col-md-12">
                  <mat-radio-button *ngIf="question.answer.hasOther" [value]="question.answer.options.length">
                    {{ question.answer.otherLabel }}
                  </mat-radio-button>
                </div>

              </mat-radio-group>
              <mat-form-field appearance="outline" *ngIf="question.answer.selected === question.answer.options.length">
                <mat-label>{{ question.answer.otherLabel }}</mat-label>
                <input matInput type="text" [(ngModel)]="question.answer.otherInput" required
                  [ngModelOptions]="{standalone: true}" [disabled]="isDisabled">
              </mat-form-field>

            </nb-accordion-item-body>
          </nb-accordion-item>
        </nb-accordion>
      </div>

      <!-- <nb-card-footer>
        <div *ngIf="question.type !== InputType.Label">
          <mat-slide-toggle labelPosition="before" [(ngModel)]="question.required">Required:</mat-slide-toggle>
          <span class="divider">|</span>
        </div>
        <button mat-icon-button type="button" class="m-0" (click)="duplicateQuestion(iQuestion)">
          <mat-icon>filter_none</mat-icon>
        </button>
        <button mat-icon-button type="button" (click)="deleteQuestion(iQuestion)">
          <mat-icon>delete</mat-icon>
        </button>
      </nb-card-footer> -->

    </nb-card>

    <!-- Add other form -->
    <div class="text-center">
      <button mat-flat-button type="button" color="primary" (click)="addQuestion()">
        <mat-icon class="text-white m-r-5">add_circle_outline</mat-icon> Add other form
      </button>
    </div>

    <div class="text-right m-r-20">
      <small class="text-red">{{ jobPositionError || questionError  }}</small>
    </div>
  </div>

  <div class="footer">
    <div class="text-left">
      <button mat-flat-button type="button" (click)="back()">
        <mat-icon>keyboard_backspace</mat-icon> Back
      </button>
    </div>
    <div class="text-right">
      <button nbButton type="button" status="primary" (click)="preview()">
        <nb-icon icon="eye-outline"></nb-icon> PREVIEW
      </button>
      <button nbButton type="submit" status="success" class="m-l-10" (click)="save()">
        <nb-icon icon="save-outline"></nb-icon> SAVE
      </button>
    </div>
  </div>

</div>